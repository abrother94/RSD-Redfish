SET(TARGET_LIB rmm_jsonrpc)
SET(TARGET_JSONRPCTEST jsonrpctest)

SET(SRC_LIB jsonrpc.c)
SET(SRC_JSONRPCTEST jsonrpctest.c)

SET(LIBRARY_OUTPUT_PATH ${PROJECT_BINARY_DIR}/lib)

SET(EXECUTABLE_OUTPUT_PATH ${PROJECT_BINARY_DIR}/bin)

LINK_DIRECTORIES(${PROJECT_BINARY_DIR}/lib)
INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/src/include)

ADD_LIBRARY(${TARGET_LIB} SHARED ${SRC_LIB})
TARGET_LINK_LIBRARIES(${TARGET_LIB} libpthread.so librt.so)

ADD_EXECUTABLE(${TARGET_JSONRPCTEST} ${SRC_JSONRPCTEST})
ADD_DEPENDENCIES(${TARGET_JSONRPCTEST} ${TARGET_LIB})
TARGET_LINK_LIBRARIES(${TARGET_JSONRPCTEST} librmm_json.so librmm_jsonrpc.so librmm_securec.so)
